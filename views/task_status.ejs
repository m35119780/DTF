<%- include('base') %>

<div class="row">
  <div class="col-lg-8 mx-auto">
    <div class="section-card">
      <h1 class="section-title">حالة معالجة الصور</h1>
      <p class="section-subtitle">جاري معالجة وترتيب الصور الخاصة بك على لوحة DTF</p>
      
      <div id="task-status" data-task-id="<%= taskId %>">
        <div class="status-container">
          <div class="text-center mb-4">
            <div class="status-icon">
              <i class="fas fa-cog fa-spin fa-3x text-primary"></i>
            </div>
            <h3 id="status-text" class="mt-3">جاري المعالجة...</h3>
          </div>
          
          <div class="progress mb-3">
            <div id="task-progress-bar" class="progress-bar" role="progressbar" style="width: 0%"></div>
          </div>
          
          <div class="text-center mb-4">
            <span id="progress-value">0%</span> مكتمل
          </div>
          
          <div class="processing-steps">
            <div class="step-item active">
              <div class="step-icon">
                <i class="fas fa-file-upload"></i>
              </div>
              <div class="step-text">تحليل الصور</div>
            </div>
            
            <div class="step-connector"></div>
            
            <div class="step-item">
              <div class="step-icon">
                <i class="fas fa-object-group"></i>
              </div>
              <div class="step-text">تحسين المواضع</div>
            </div>
            
            <div class="step-connector"></div>
            
            <div class="step-item">
              <div class="step-icon">
                <i class="fas fa-file-pdf"></i>
              </div>
              <div class="step-text">إنشاء الملفات</div>
            </div>
          </div>
        </div>
        
        <div class="text-center mt-5">
          <p class="task-info">قد تستغرق المعالجة بضع دقائق حسب عدد الصور وتعقيدها.</p>
          <p class="task-info">يرجى عدم إغلاق هذه النافذة أو تحديثها حتى تكتمل العملية.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .status-container {
    background-color: #f9f9f9;
    border-radius: 8px;
    padding: 2rem;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
  }
  
  .processing-steps {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 3rem;
    margin-bottom: 1rem;
  }
  
  .step-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100px;
  }
  
  .step-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: #e9ecef;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #6c757d;
    font-size: 1.2rem;
    margin-bottom: 10px;
  }
  
  .step-item.active .step-icon {
    background-color: #3498db;
    color: white;
  }
  
  .step-item.completed .step-icon {
    background-color: #2ecc71;
    color: white;
  }
  
  .step-connector {
    flex-grow: 1;
    height: 3px;
    background-color: #e9ecef;
  }
  
  .task-info {
    color: #666;
    font-size: 0.9rem;
  }
</style> 